<head>
<link rel="stylesheet" type="text/css" href="qrc:///StyleSheets/Help/general.css">
<meta charset="UTF-8">
</head>
<body>
	<p>A <strong>Serial to Parallel Interface (SPI)</strong> block can be configured in one of two modes: Serial to Parallel (S2P) or Parallel to Serial (P2S). In S2P mode, SPI will convert 2-bytes of serial data into a 2-byte parallel bus. In P2S mode, SPI will convert a 2-byte parallel bus into 2-bytes of serial data. The Inputs are standard SPI I/O connections (MOSI, MISO, nCSB, SCLK, and OUTs).</p>

	<p>The INTR (Interrupt) output goes HIGH on the last clock once the Parallel Data in P2S mode has been fully clocked out.</p>

	<h4>S2P activation</h4><hr>

	<p>Remove the connection of VDD to the nCSB input. <br />
MOSI connection: Set PIN10 mode to Digital Input and select SPI &lt;- PIN12 (out) for the &#8216;Serial data&#8217; connection parameter. An orange wire will show denoting the connection.<br />
Connect both the nCSB and SCLK to either the matrix or PINs.<br />
See the &#8216;Connection&#8217; section for PAR_OUT connections.</p>

	<h4>P2S activation</h4><hr>

	<p>Remove the connection of VDD to the nCSB input. <br />
MISO connection: Set PIN10 mode to Digital Output and select ADC -&gt; PIN12(in) for the &#8216;Serial data&#8217; connection parameter. An orange wire will show denoting the connection.<br />
PAR_IN connection: Select FSM0/FSM1 or ADC as the &#8216;PAR Input data source&#8217; connection parameter. <br />
Connect both the nCSB and SCLK to either the matrix or PINs.</p>

	<h4>Parameters</h4><hr>

	<h3>Mode</h3>

	<p style="margin-left:2em;">The SPI block can either convert from Serial to Parallel or Parallel to Serial.</p>

<p>
	<p class = "li1">• <strong>S2P</strong>: The SPI block will convert Serial data into Parallel data;</p>
	<p class = "li1">• <strong>P2S</strong>: The conversion is from Parallel data to Serial;</p><br />
</p>

	<h3>Clock phase (CPHA)</h3>

	<p style="margin-left:2em;">The Clock phase determines which edge the data starts sampling at.</p>

<p>
	<p class = "li1">• <strong>0</strong>: the SPI samples on the first edge;</p>
	<p class = "li1">• <strong>1</strong>: the SPI samples on the second edge;</p><br />
</p>

	<h3>Clock polarity (CPOL)</h3>

	<p style="margin-left:2em;">The Clock polarity determines the base value of the clock</p>

<p>
	<p class = "li1">• <strong>0</strong>: clock has a base value of 0;</p>
	<p class = "li1">• <strong>1</strong>: clock has a base value of 1;</p><br />
</p>

	<h3>Byte selection</h3>

	<p style="margin-left:2em;">Choose the number of bytes to input or output from the SPI block</p>

	<h3>ADC data sync with SPI clock</h3>

	<p style="margin-left:2em;">ADC parallel output will be synced to SPI Parallel Input even if ADC and SPI do not have the same Clk source.</p>

	<h3>PWM data sync with SPI clock</h3>

	<p style="margin-left:2em;">PWM parallel output will be synced to SPI Parallel Input even if PWM and SPI do not have the same Clk source.</p>

	<h3>FSM data sync with SPI clock</h3>

	<p style="margin-left:2em;">FSM parallel output will be synced to SPI Parallel Input even if FSM and SPI do not have the same Clk source.</p>

	<h4>Connections</h4><hr>

	<p>PAR_IN and Serial in and Serial out connections can be configured here. PAR_OUT is configured at the receiving block. To configure PAR_OUT connections, go to either the FSM0, DCMP or DACs and choose SPI[15:8] or SPI[7:0] as the parallel input source. </p>

	<p>In order to have the SPI block drive the DACs, the DAC must be configured as having the same input source as DCMP1 and the DCMP1 must have the SPI connection as its input source.</p>

	<h3>PAR input data source</h3>

	<p style="margin-left:2em;">The parallel input is multiplexed between FSM0/FSM1 and ADC.</p>

	<h3>Serial data out</h3>

	<p style="margin-left:2em;">The serial output line is multiplexed between the SPI and ADC serial outputs. Only one connection is available at a time.</p>

<p>
	<p class = "li1">• <strong>Disable (Matrix -&gt; PIN12 (in))</strong>: the connection is disabled between PIN12 and the serial output connections. The PIN12 (in) can be connected from the matrix;</p>
	<p class = "li1">• <strong>SPI -&gt; PIN12 (in)</strong>: the serial output of the SPI is connected to PIN12. PIN12 needs to be configured as a Digital Output;</p>
	<p class = "li1">• <strong>ADC -&gt; PIN12 (in)</strong>: the serial output of the ADC is connected to PIN12. PIN12 needs to be configured as a Digital Output;</p><br />
</p>

	<h3>INTR</h3>

	<p style="margin-left:2em;">The interrupt pin is only active in the P2S mode. On the falling edge of the last clock 8-th or 16-th clock, the interrupt pin will be HIGH for 1 clock cycle. If the polarity is set to CPOL enabled, the interrupt pin will begin on the rising edge of the clock.</p>

	<h3>nCSB:</h3>

	<p style="margin-left:2em;">nCSB is an active low chip select. If nCSB is low, the SPI block is enabled.</p>

	<h3>SCLK:</h3>

	<p style="margin-left:2em;">SCLK is the serial clock which clocks the SPI block.</p>
</body>